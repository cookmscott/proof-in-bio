import"./CWj6FrbW.js";import"./DKoAsFJN.js";import{c as f,f as p,a as m}from"./DP-BcMQ1.js";import{I as h,s as g}from"./BhJnL3fA.js";import{l as $,s as v}from"./CrcHuKx2.js";import{S as U,b as q}from"./Br5xYnQO.js";import{P as R}from"./Bxqa2uf9.js";function de(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["path",{d:"m6 9 6 6 6-6"}]];h(e,v({name:"chevron-down"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function F(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M8 12h8"}],["path",{d:"M12 8v8"}]];h(e,v({name:"circle-plus"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function G(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["path",{d:"m16 18 6-6-6-6"}],["path",{d:"m8 6-6 6 6 6"}]];h(e,v({name:"code"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function ue(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2"}],["circle",{cx:"9",cy:"9",r:"2"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"}]];h(e,v({name:"image"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function k(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["path",{d:"M11 12H3"}],["path",{d:"M16 6H3"}],["path",{d:"M16 18H3"}],["path",{d:"M21 12h-6"}]];h(e,v({name:"list-minus"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function A(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["path",{d:"M11 19H5v-6"}],["path",{d:"M13 5h6v6"}],["path",{d:"M19 5 5 19"}]];h(e,v({name:"move-diagonal"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function B(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["path",{d:"M4 11a9 9 0 0 1 9 9"}],["path",{d:"M4 4a16 16 0 0 1 16 16"}],["circle",{cx:"5",cy:"19",r:"1"}]];h(e,v({name:"rss"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function J(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["path",{d:"M14 17H5"}],["path",{d:"M19 7h-9"}],["circle",{cx:"17",cy:"17",r:"3"}],["circle",{cx:"7",cy:"7",r:"3"}]];h(e,v({name:"settings-2"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}function L(e,a){const t=$(a,["children","$$slots","$$events","$$legacy"]),i=[["path",{d:"M4 10c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2"}],["path",{d:"M10 16c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2"}]];h(e,v({name:"square-stack"},()=>t,{get iconNode(){return i},children:(r,n)=>{var s=f(),c=p(s);g(c,a,"default",{}),m(r,s)},$$slots:{default:!0}}))}const T="0.5.6";let N=null;const K={"c2pa.created":{order:1,label:"Creation & Ingestion",icon:F},"c2pa.opened":{order:1,label:"Creation & Ingestion",icon:F},"c2pa.placed":{order:2,label:"Editorial Content Changes",icon:R},"c2pa.edited":{order:2,label:"Editorial Content Changes",icon:R},"c2pa.color_adjustments":{order:3,label:"Color & Tone Adjustments",icon:J},"c2pa.filtered":{order:4,label:"Enhancement (Non-Editorial)",icon:q},"c2pa.metadata":{order:7,label:"Metadata-Only Changes",icon:G},"c2pa.cropped":{order:8,label:"Resizing & Scaling",icon:A},"c2pa.resized":{order:8,label:"Resizing & Scaling",icon:A},"c2pa.orientation":{order:8,label:"Resizing & Scaling",icon:A},"c2pa.converted":{order:9,label:"File / Format Transformations",icon:L},"c2pa.transcoded":{order:9,label:"File / Format Transformations",icon:L},"c2pa.published":{order:10,label:"Publishing & Distribution",icon:B},"c2pa.redacted":{order:11,label:"Removal & Redaction",icon:k},"c2pa.removed":{order:11,label:"Removal & Redaction",icon:k},"c2pa.watermarked":{order:12,label:"Watermarking",icon:U}};function fe(e){return K[e]||{order:99,label:"Other Actions",icon:G}}function pe(e){const a=e.parameters;if(!a)return null;if(a["com.adobe.acr"]){const i=a["com.adobe.acr"],r=a["com.adobe.acr.value"];return r?`${i}: ${r}`:i}if(a.ingredients)return`Imported ${a.ingredients.length} asset(s)`;const t=Object.keys(a).filter(i=>i!=="instance_id");return t.length>0?t.join(", "):null}function Q(e){const a=(e==null?void 0:e.manifests)??(e==null?void 0:e.manifests_map)??(e==null?void 0:e.manifestsMap)??{};let t=(e==null?void 0:e.active_manifest)??(e==null?void 0:e.activeManifest)??null;t&&typeof t=="object"&&t.label&&(t=t.label);const i=(e==null?void 0:e.validation_status)??(e==null?void 0:e.validationStatus)??[],r=(e==null?void 0:e.validation_results)??(e==null?void 0:e.validationResults)??null,n=(e==null?void 0:e.validation_state)??(e==null?void 0:e.validationState)??null;return{active_manifest:t,manifests:a,validation_status:i,validation_results:r,validation_state:n}}function E(e=""){const a=e.match(/__(\d+)$/);return a?Number(a[1]):0}function X(e=""){return/^c2pa\.actions(\.[a-z0-9_]+)?(__\d+)?$/i.test(e)}function Y(e){const a=Array.isArray(e==null?void 0:e.actions)?e.actions:[],t=e==null?void 0:e.templates;if(!t)return a;const i=Array.isArray(t)?t:typeof t=="object"?Object.entries(t).map(([r,n])=>({action:r,...n||{}})):[];return i.length?a.map(r=>{const n=r==null?void 0:r.action;if(!n)return r;const s={};for(const o of i){const l=o==null?void 0:o.action;if(!l||l!=="*"&&l!==n)continue;const d=o.templateParameters||o.parameters;Object.assign(s,o),d&&typeof d=="object"&&(s.parameters={...s.parameters||{},...d})}const c={...s,...r};return c.parameters={...s.parameters||{},...(r==null?void 0:r.parameters)||{}},delete c.templateParameters,c}):a}function C(e=[]){if(!Array.isArray(e)||e.length===0)return{actionsLabels:[],actions:[]};const a=e.filter(n=>X((n==null?void 0:n.label)||"")).sort((n,s)=>E(n.label)-E(s.label)),t=[],i=[];for(const n of a){i.push(n.label);const s=(n==null?void 0:n.data)||null,c=Y(s);for(const o of c)t.push(o)}return t.some(n=>n==null?void 0:n.when)&&t.sort((n,s)=>{const c=n!=null&&n.when?Date.parse(n.when):NaN,o=s!=null&&s.when?Date.parse(s.when):NaN;return!Number.isNaN(c)&&!Number.isNaN(o)?c-o:Number.isNaN(c)?Number.isNaN(o)?0:1:-1}),{actionsLabels:i,actions:t}}function j(e){var s,c;const{actions:a}=C((e==null?void 0:e.assertions)||[]);if(!a.length)return!1;const t=a.find(o=>(o==null?void 0:o.action)==="c2pa.created");if(!t)return!1;const i="http://cv.iptc.org/newscodes/digitalsourcetype/",r=t.digitalSourceType||t[i]||((s=t.parameters)==null?void 0:s.digitalSourceType)||((c=t.parameters)==null?void 0:c[i]);if(!r)return!1;const n=String(r);return n.includes("digitalCapture")||n.includes("computationalCapture")}function Z(e){if(!e||typeof e!="string")return null;const a=e.lastIndexOf("c2pa.assertions/");return a===-1?null:e.substring(a+16)}function ee(e){const a=new Map;for(const t of(e==null?void 0:e.ingredients)||[]){const i=t==null?void 0:t.label;i&&a.set(i,t)}return a}function te(e){var r;const{actions:a}=C((e==null?void 0:e.assertions)||[]);if(!a.length)return[];const t=ee(e),i=new Set;for(const n of a){const s=(r=n==null?void 0:n.parameters)==null?void 0:r.ingredients;if(Array.isArray(s))for(const c of s){const o=Z(c==null?void 0:c.url);if(!o)continue;const l=t.get(o)||t.get(o.replace(/__(\d+)$/,"")),d=(l==null?void 0:l.active_manifest)||(l==null?void 0:l.activeManifest)||(l==null?void 0:l.manifest_id)||(l==null?void 0:l.manifestId)||null;d&&i.add(d)}}return[...i]}function O(e){const a=new Set;for(const t of(e==null?void 0:e.ingredients)||[]){const i=(t==null?void 0:t.active_manifest)||(t==null?void 0:t.activeManifest)||(t==null?void 0:t.manifest_id)||(t==null?void 0:t.manifestId)||null;i&&a.add(i)}for(const t of te(e))a.add(t);return[...a]}function W(e,a){var i,r;const t=(e==null?void 0:e.validation_results)||(e==null?void 0:e.validationResults);return!t||!a?null:(i=t.manifests)!=null&&i[a]?t.manifests[a]:(r=t.manifestResults)!=null&&r[a]?t.manifestResults[a]:a===e.active_manifest&&t.activeManifest?t.activeManifest:null}function D(e){const a=(e==null?void 0:e.failure)||[],t=(e==null?void 0:e.success)||[],i=a.some(n=>(n.code||"").startsWith("claimSignature.")||(n.code||"").startsWith("assertion.dataHash.")||(n.code||"").startsWith("assertion.hashedURI."));return t.some(n=>(n.code||"")==="claimSignature.validated")&&!i}function me(e){var w,I,z;if(!e||!e.manifests)return{hasManifest:!1,hasActions:!1};const a=e.active_manifest,t=(w=e.manifests)==null?void 0:w[a];if(!t)return{hasManifest:!1,hasActions:!1};const i=!0,{actions:r}=C(t.assertions||[]),n=r.length>0,s=j(t);let c=s,o=s?t:null,l=s?a:null;if(!c){const u=O(t),b=new Set([a]);for(;u.length;){const _=u.shift();if(!_||b.has(_))continue;const M=(I=e.manifests)==null?void 0:I[_];if(M){if(b.add(_),j(M)){c=!0,o=M,l=_;break}for(const y of O(M))y&&!b.has(y)&&u.push(y)}}}const d=u=>{var b,_;return((b=u==null?void 0:u.signature_info)==null?void 0:b.common_name)||((_=u==null?void 0:u.signature_info)==null?void 0:_.issuer)||"Unknown"},x=W(e,a)||((z=e.validation_results)==null?void 0:z.activeManifest),S=D(x),P=l?W(e,l):null,V=c?l&&P?D(P):s?S:null:null,H=!((x==null?void 0:x.failure)||[]).some(u=>(u.code||"")==="signingCredential.untrusted");return{hasManifest:i,hasActions:n,hasCaptureProvenance:c,activeIsCapture:s,activeSigner:d(t),captureSigner:o?d(o):null,activeSignatureValidated:S,signatureValidated:S,signingCredentialTrusted:H,captureSignatureValidated:V,actions:r}}function he(e){var s;if(!e)return{};const a=Q(e),t=(s=a.manifests)==null?void 0:s[a.active_manifest];if(!t)return{};const i={c2pa_manifest:e},n=(c=>{var o,l;return(l=(o=t.assertions)==null?void 0:o.find(d=>d.label&&d.label.startsWith(c)))==null?void 0:l.data})("stds.exif")||{};return i.exif_data=n,i.camera=n["tiff:Model"]||n["tiff:Make"]||null,i.lens=n["aux:Lens"]||n["exif:LensModel"]||null,i.focal_length=n["exif:FocalLength"]?String(n["exif:FocalLength"]):null,i.aperture=n["exif:FNumber"]?String(n["exif:FNumber"]):null,i.shutter_speed=n["exif:ExposureTime"]?String(n["exif:ExposureTime"]):null,i.iso=n["exif:IsoSpeedRatings"]?Number(n["exif:IsoSpeedRatings"]):null,i.captured_at=n["exif:DateTimeOriginal"]||n["exif:DateTimeDigitized"]||null,i.flash=n["exif:Flash"]?String(n["exif:Flash"]):null,i.white_balance=n["exif:WhiteBalance"]?String(n["exif:WhiteBalance"]):null,i.exposure_mode=n["exif:ExposureMode"]?String(n["exif:ExposureMode"]):null,i.metering_mode=n["exif:MeteringMode"]?String(n["exif:MeteringMode"]):null,i.gps_lat=n["exif:GPSLatitude"]?Number(n["exif:GPSLatitude"]):null,i.gps_lng=n["exif:GPSLongitude"]?Number(n["exif:GPSLongitude"]):null,i.gps_alt=n["exif:GPSAltitude"]?Number(n["exif:GPSAltitude"]):null,i}async function ge(){if(N)return N;try{const t=(await import(`https://cdn.jsdelivr.net/npm/@contentauth/c2pa-web@${T}/+esm`)).createC2pa;return N=await t({wasmSrc:`https://cdn.jsdelivr.net/npm/@contentauth/c2pa-web@${T}/dist/resources/c2pa_bg.wasm`}),N}catch(e){throw console.error("Failed to load C2PA library",e),new Error("Failed to load C2PA library. Please check your internet connection.")}}export{de as C,ue as I,me as a,he as e,pe as f,fe as g,ge as l,Q as n};
