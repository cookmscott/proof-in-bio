import"../chunks/CWj6FrbW.js";import{p as Fe,b as h,a as v,d as Ne,e as o,s as l,g as Te,h as Ue,i as t,r as n,u as ue,f as y,j as je,t as Ie,k as F,c as J}from"../chunks/C2C4OSbN.js";import{s as $}from"../chunks/CaX8zT8B.js";import{i as K}from"../chunks/DMomQ0_j.js";import{e as O}from"../chunks/DHZx8vpx.js";import{c as b}from"../chunks/U4ZWPL4m.js";import{s as R}from"../chunks/TSTVjuax.js";import{I as ze}from"../chunks/CmjDAzlH.js";import{C as Be,a as Ee,b as He,c as Le,d as Ye}from"../chunks/PCIgc6O-.js";import{A as qe,a as Qe,b as Je}from"../chunks/ji_QvPLU.js";import{S as Ke,H as Oe,E as Re}from"../chunks/DjQpZY0L.js";var Ve=h('<div class="text-center py-12 text-muted-foreground"><p>No photos found.</p></div>'),We=h("<!> <!>",1),Xe=h('<a class="group relative block aspect-[4/5] overflow-hidden rounded-lg border bg-muted shadow-sm transition-all hover:shadow-md"><img alt="" class="h-full w-full object-cover" loading="lazy"/> <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-100 group-hover:opacity-0 transition-opacity duration-300"></div> <div class="absolute bottom-0 left-0 right-0 p-3 flex items-center justify-between text-white text-xs opacity-100 group-hover:opacity-0 transition-opacity duration-300"><div class="flex items-center gap-1"><!> <span> </span></div> <div class="flex items-center gap-1"><!> <span> </span></div></div></a>'),Ze=h("<!> <!>",1),Ge=h("<!> <!>",1),ea=h('<div class="space-y-4"><div class="flex items-center gap-3"><!> <div class="flex flex-col leading-none"><a class="font-semibold hover:underline decoration-primary underline-offset-4 text-sm"> </a> <span class="text-xs text-muted-foreground mt-1"> </span></div></div> <div class="relative"><!></div></div>'),aa=h('<div class="relative"><div class="sticky top-0 z-10 bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 py-3 mb-6 border-b"><h2 class="text-sm font-semibold text-muted-foreground uppercase tracking-wider flex items-center gap-2"><span class="w-1.5 h-1.5 rounded-full bg-primary/50"></span> </h2></div> <div class="space-y-10 pl-2 md:pl-4 border-l border-border/40 ml-0.5 md:ml-1"></div></div>'),ta=h('<div class="container py-8 max-w-3xl mx-auto space-y-8 px-4 md:px-6"><div class="relative max-w-md mx-auto mb-8"><!> <!></div> <div class="space-y-12"><!> <!></div></div>');function _a(me,V){Fe(V,!0);let N=Ue("");const fe=new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",year:"numeric"}),_e=e=>{if(!e)return{key:"unknown",label:"Unknown date",value:-1};const a=new Date(e);if(Number.isNaN(a.getTime()))return{key:"unknown",label:"Unknown date",value:-1};const r=`${a.getFullYear()}-${String(a.getMonth()+1).padStart(2,"0")}-${String(a.getDate()).padStart(2,"0")}`,c=new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime();return{key:r,label:fe.format(a),value:c}};let W=ue(()=>{var k;const e=[],a=t(N).toLowerCase().trim();for(const d of V.data.users??[])if(!(a&&!((k=d.username)!=null&&k.toLowerCase().includes(a)))&&d.photos)for(const i of d.photos)e.push({...i,user:d});const r=new Map;for(const d of e){const{key:i,label:x,value:s}=_e(d.created_at);r.has(i)||r.set(i,{key:i,label:x,value:s,items:[]}),r.get(i).items.push(d)}return Array.from(r.values()).sort((d,i)=>i.value-d.value).map(d=>{const i=new Map;for(const s of d.items){const _=s.user.username;i.has(_)||i.set(_,{user:s.user,photos:[]}),i.get(_).photos.push(s)}const x=Array.from(i.values()).sort((s,_)=>{const C=Math.max(...s.photos.map(w=>new Date(w.created_at??0).getTime()));return Math.max(..._.photos.map(w=>new Date(w.created_at??0).getTime()))-C});return{...d,userGroups:x}})});const T=new Map,pe=e=>{let a=0;for(let r=0;r<e.length;r+=1)a=(a<<5)-a+e.charCodeAt(r),a|=0;return Math.abs(a)},X=(e,a,r)=>{const c=r-a+1;return a+e%c},ge=e=>{const a=`${(e==null?void 0:e.id)??"no-id"}|${(e==null?void 0:e.storage_url)??""}|${(e==null?void 0:e.created_at)??""}`;if(T.has(a))return T.get(a);const r=pe(a),c={likes:Number.isFinite(e==null?void 0:e.like_count)&&e.like_count>0?e.like_count:X(r,8,420),views:Number.isFinite(e==null?void 0:e.view_count)&&e.view_count>0?e.view_count:X(r*7,150,12e3)};return T.set(a,c),c};var U=ta(),j=o(U),Z=o(j);Ke(Z,{class:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"});var be=l(Z,2);ze(be,{placeholder:"Search users...",class:"pl-9 bg-background border-input",get value(){return t(N)},set value(e){Te(N,e,!0)}}),n(j);var G=l(j,2),ee=o(G);{var he=e=>{var a=Ve();v(e,a)};K(ee,e=>{t(W).length===0&&e(he)})}var xe=l(ee,2);O(xe,17,()=>t(W),e=>e.key,(e,a)=>{var r=aa(),c=o(r),k=o(c),d=l(o(k));n(k),n(c);var i=l(c,2);O(i,21,()=>t(a).userGroups,x=>x.user.username,(x,s)=>{var _=ea(),C=o(_),I=o(C);b(I,()=>Je,(z,B)=>{B(z,{class:"h-9 w-9 border border-border",children:(E,ke)=>{var D=We(),S=y(D);{var H=u=>{var p=J(),g=y(p);b(g,()=>Qe,(M,m)=>{m(M,{get src(){return t(s).user.avatar_url},get alt(){return t(s).user.username}})}),v(u,p)};K(S,u=>{t(s).user.avatar_url&&u(H)})}var L=l(S,2);b(L,()=>qe,(u,p)=>{p(u,{children:(g,M)=>{je();var m=Ie();F(f=>$(m,f),[()=>{var f;return((f=t(s).user.username)==null?void 0:f.slice(0,2).toUpperCase())||"U"}]),v(g,m)},$$slots:{default:!0}})}),v(E,D)},$$slots:{default:!0}})});var w=l(I,2),A=o(w),we=o(A,!0);n(A);var ae=l(A,2),ye=o(ae);n(ae),n(w),n(C);var te=l(C,2),$e=o(te);b($e,()=>Ye,(z,B)=>{B(z,{opts:{align:"start",loop:!1},class:"w-full",children:(E,ke)=>{var D=Ge(),S=y(D);b(S,()=>Be,(u,p)=>{p(u,{class:"-ml-4",children:(g,M)=>{var m=J(),f=y(m);O(f,17,()=>t(s).photos,Y=>Y.id,(Y,q)=>{var re=J();const se=ue(()=>ge(t(q)));var Ce=y(re);b(Ce,()=>Ee,(De,Se)=>{Se(De,{class:"pl-4 basis-1/2 sm:basis-1/3",children:(Me,ra)=>{var P=Xe(),ne=o(P),oe=l(ne,4),Q=o(oe),ie=o(Q);Oe(ie,{class:"h-3 w-3 fill-current"});var le=l(ie,2),Ae=o(le,!0);n(le),n(Q);var de=l(Q,2),ve=o(de);Re(ve,{class:"h-3 w-3"});var ce=l(ve,2),Pe=o(ce,!0);n(ce),n(de),n(oe),n(P),F(()=>{R(P,"href",`/${t(s).user.username??""}/${t(q).id??""}`),R(ne,"src",t(q).storage_url),$(Ae,t(se).likes),$(Pe,t(se).views)}),v(Me,P)},$$slots:{default:!0}})}),v(Y,re)}),v(g,m)},$$slots:{default:!0}})});var H=l(S,2);{var L=u=>{var p=Ze(),g=y(p);b(g,()=>He,(m,f)=>{f(m,{class:"left-2 hidden md:flex h-8 w-8"})});var M=l(g,2);b(M,()=>Le,(m,f)=>{f(m,{class:"right-2 hidden md:flex h-8 w-8"})}),v(u,p)};K(H,u=>{t(s).photos.length>2&&u(L)})}v(E,D)},$$slots:{default:!0}})}),n(te),n(_),F(()=>{R(A,"href",`/${t(s).user.username??""}`),$(we,t(s).user.username),$(ye,`Added ${t(s).photos.length??""} photo${t(s).photos.length===1?"":"s"}`)}),v(x,_)}),n(i),n(r),F(()=>$(d,` ${t(a).label??""}`)),v(e,r)}),n(G),n(U),v(me,U),Ne()}export{_a as component};
